C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 14:27:42 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Users\M\AppData\Local\Keil\Keil_v4\C51\BIN\C51.EXE ..\lib\user\main.c LARGE OPTIMIZE(8,SPEED) BR
                    -OWSE INCDIR(..\lib\n76e003\Include;..\lib\user\inc) DEFINE(FOSC_160000) DEBUG OBJECTEXTEND PRINT(.\Listings\main.lst) TA
                    -BS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include "func.h"
   2          
   3          void feedDogInIsr(unsigned int ms);
   4          
   5          void initTimer3(void)
   6          {
   7   1        T3CON = 0x07; //128åˆ†é¢‘
   8   1        
   9   1        RH3 = (65536-125)/256;  //1ms
  10   1        RL3 = (65536-125)%256;   
  11   1       
  12   1        set_ET3;  //enable Timer3 interrupt
  13   1        set_EA; //enable interrupts
  14   1        set_TR3;  //Timer3 run
  15   1      }
  16          
  17          void Timer3_ISR (void) interrupt 16
  18          {
  19   1        clr_TF3;
  20   1        run();
  21   1      
  22   1        feedDogInIsr(2000); //å–‚ç‹—
  23   1      }
  24          
  25          void wtd_init(void)
  26          {
  27   1          TA=0xAA;
  28   1          TA=0x55;
  29   1      
  30   1          WDCON = 0x7; //æ ¹æ®æ‰‹å†Œ [2:0]ä½è¡¨ç¤ºä¸­æ–­åœ¨å¤šå°‘ç§’åæ‰§è¡Œï¼Œ0x7è¡¨ç¤º1.638såä¸­æ–­æ‰§è¡Œ
             -ã€‚æ ¹æ®éœ€è¦ä¿®æ”¹ä½3ä½
  31   1          set_WDTR;
  32   1          set_WDCLR;
  33   1          set_EWDT; 
  34   1        set_EA;//æ€»ä¸­æ–­è®°å¾—å¼€å¯ï¼Œset_EA;   
  35   1      }
  36          
  37          #define feedDog() set_WDCLR;  //å–‚ç‹—
  38          static unsigned int feedDogTimeCount = 0; //å–‚ç‹—æ ‡å¿—
  39          
  40          void feedDogInMain(void)
  41          {
  42   1        feedDogTimeCount = 0;
  43   1      }
  44          
  45          void feedDogInIsr(unsigned int ms)
  46          {
  47   1        //å†ä¸»å¾ªç¯ä¸­æ¸…é™¤å–‚ç‹—æ ‡å¿—ï¼Œåœ¨ä¸­æ–­ä¸­å–‚ç‹—ï¼Œå¦‚æœä¸»å¾ªç¯ä¸­ä¸¤ç§’æ²¡æœ‰æ¸…é™¤æ ‡å¿—åˆ™è
             -®¤ä¸ºä¸»å¾ªç¯æ­»äº†ï¼Œé‚£å°±åœæ­¢å–‚ç‹—
  48   1        //å¦‚æœä¸­æ–­æ­»äº†,ä¹Ÿä¼šåœæ­¢å–‚ç‹—
  49   1        if(++feedDogTimeCount < ms)
  50   1        {
  51   2          feedDogTimeCount = 0;
C51 COMPILER V9.60.0.0   MAIN                                                              12/23/2019 14:27:42 PAGE 2   

  52   2          feedDog();
  53   2        }
  54   1      }
  55          
  56          void main(void)
  57          {
  58   1        init();
  59   1        initTimer3();
  60   1        wtd_init();
  61   1        feedDogInMain();  //å–‚ç‹—
  62   1      
  63   1        while(1)
  64   1        {
  65   2          feedDogInMain();  //å–‚ç‹—
  66   2          runMain();
  67   2        }
  68   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    214    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      2    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
